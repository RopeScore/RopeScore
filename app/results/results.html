<h1>{{ data[id].config.name }} Results</h1>
<div class="table">
  <table id="resultsTable">
    <thead>
      <tr>
        <th class="blank" colspan="3" rowspan="2"></th>
        <th colspan="{{ Abbr.count(data[id].config.subevents, 'sr') * 2 }}" ng-if="Abbr.hasSR(data[id].config.subevents)">Single Rope</th>
        <th colspan="{{ Abbr.count(data[id].config.subevents, 'dd') * 2 }}" ng-if="Abbr.hasDD(data[id].config.subevents)">Double Dutch</th>
        <th colspan="3" rowspan="2">Overall</th>
      </tr>
      <tr>
        <th colspan="2" ng-if="data[id].config.subevents.srss">{{ Abbr.unabbr("srss")}}</th>
        <th colspan="2" ng-if="data[id].config.subevents.srse">{{ Abbr.unabbr("srse")}}</th>
        <th colspan="2" ng-if="data[id].config.subevents.srsf">{{ Abbr.unabbr("srsf")}}</th>
        <th colspan="2" ng-if="data[id].config.subevents.srsr">{{ Abbr.unabbr("srsr")}}</th>
        <th colspan="2" ng-if="data[id].config.subevents.srpf">{{ Abbr.unabbr("srpf")}}</th>
        <th colspan="2" ng-if="data[id].config.subevents.srtf">{{ Abbr.unabbr("srtf")}}</th>
        <th colspan="2" ng-if="data[id].config.subevents.srp">{{ Abbr.unabbr("srp")}}</th>
        <th colspan="2" ng-if="data[id].config.subevents.srd">{{ Abbr.unabbr("srd")}}</th>

        <th colspan="2" ng-if="data[id].config.subevents.ddsr">{{ Abbr.unabbr("ddsr")}}</th>
        <th colspan="2" ng-if="data[id].config.subevents.ddsf">{{ Abbr.unabbr("ddsf")}}</th>
        <th colspan="2" ng-if="data[id].config.subevents.ddpf">{{ Abbr.unabbr("ddpf")}}</th>
      </tr>
      <tr>
        <th>{{ (Abbr.hasDD(data[id].config.subevents) ? "Team Name" : "Name") }}</th>
        <th>Club</th>
        <th>id</th>

        <th ng-repeat-start="n in getNumber(Abbr.count(data[id].config.subevents)) track by $index">Score</th>
        <th style="color:red" ng-repeat-end>Rank</th>

        <th>Score</th>
        <th style="color:green">Rank Sum</th>
        <th style="color:red">Rank</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="part in partArray | orderBy :'rank'" ng-style="($even ? {} : {'background-color':'#eee'})">
        <td>{{ data[id].participants[part.uid].name }}</td>
        <td>{{ data[id].participants[part.uid].club }}</td>
        <td>{{ part.uid }}</td>

        <td ng-if="data[id].config.subevents.srss">{{ score("srss", data[id].scores[part.uid].srss, part.uid)}}</td>
        <td ng-if="data[id].config.subevents.srss" style="color:red">{{ rank(data[id].finalscores, 'srss', part.uid) }}</td>
        <td ng-if="data[id].config.subevents.srse">{{ score("srse", data[id].scores[part.uid].srse, part.uid)}}</td>
        <td ng-if="data[id].config.subevents.srse" style="color:red">{{ rank(data[id].finalscores, 'srse', part.uid) }}</td>
        <td ng-if="data[id].config.subevents.srsf">{{ score("srsf", data[id].scores[part.uid].srsf, part.uid)}}</td>
        <td ng-if="data[id].config.subevents.srsf" style="color:red">{{ rank(data[id].finalscores, 'srsf', part.uid) }}</td>
        <td ng-if="data[id].config.subevents.srsr">{{ score("srsr", data[id].scores[part.uid].srsr, part.uid) }}</td>
        <td ng-if="data[id].config.subevents.srsr" style="color:red">{{ rank(data[id].finalscores, 'srsr', part.uid) }}</td>
        <td ng-if="data[id].config.subevents.srpf">{{ score("srpf", data[id].scores[part.uid].srpf, part.uid) }}</td>
        <td ng-if="data[id].config.subevents.srpf" style="color:red">{{ rank(data[id].finalscores, 'srpf', part.uid) }}</td>
        <td ng-if="data[id].config.subevents.srtf">{{ score("srtf", data[id].scores[part.uid].srtf, part.uid) }}</td>
        <td ng-if="data[id].config.subevents.srtf" style="color:red">{{ rank(data[id].finalscores, 'srtf', part.uid) }}</td>
        <td ng-if="data[id].config.subevents.srp">{{ score("srp", data[id].scores[part.uid].srp, part.uid)}}</td>
        <td ng-if="data[id].config.subevents.srp" style="color:red">{{ rank(data[id].finalscores, 'srp', part.uid) }}</td>
        <td ng-if="data[id].config.subevents.srd">{{ score("srd", data[id].scores[part.uid].srd, part.uid)}}</td>
        <td ng-if="data[id].config.subevents.srd" style="color:red">{{ rank(data[id].finalscores, 'srd', part.uid) }}</td>

        <td ng-if="data[id].config.subevents.ddsr">{{ score("ddsr", data[id].scores[part.uid].ddsr, part.uid)}}</td>
        <td ng-if="data[id].config.subevents.ddsr" style="color:red">{{ rank(data[id].finalscores, 'ddsr', part.uid) }}</td>
        <td ng-if="data[id].config.subevents.ddsf">{{ score("ddsf", data[id].scores[part.uid].ddsf, part.uid) }}</td>
        <td ng-if="data[id].config.subevents.ddsf" style="color:red">{{ rank(data[id].finalscores, 'ddsf', part.uid) }}</td>
        <td ng-if="data[id].config.subevents.ddpf">{{ score("ddpf", data[id].scores[part.uid].ddpf, part.uid) }}</td>
        <td ng-if="data[id].config.subevents.ddpf" style="color:red">{{ rank(data[id].finalscores, 'ddpf', part.uid) }}</td>

        <td>{{ finalscore(data[id].finalscores[part.uid]) }}</td>
        <td style="color:green">{{ ranksum(data[id].ranks[part.uid]) }}</td>
        <td style="color:red">{{ rank(data[id].ranks, 'ranksum', part.uid) }}
        </td>
      </tr>
    </tbody>
  </table>
</div>

<button onclick="tableToExcel('resultsTable')">Export to excel</button>

<!-- <pre>{{ data[id] | json }}</pre> -->
