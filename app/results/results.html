<h1>{{ data[id].config.name }} Results</h1>

<button ng-click="toExcel()">Export to Excel</button>
<button ng-click="live()">{{ (isLive ? 'Stop Updating Live' : 'Update Live' ) }}</button>
<button ng-click="toggleRankAll()">Overall rank everyone</button>

<div class="table">
  <table name="raw">
    <thead>
      <tr>
        <th bold="true" class="blank" noborders colspan="3" rowspan="2"></th>
        <th bold="true" colspan="{{ Abbr.header(data[id].config.subevents, 'sr', ShowDC) }}"
          ng-if="Abbr.hasType(data[id].config.subevents, 'sr')">Single Rope</th>
        <th bold="true" colspan="{{ Abbr.header(data[id].config.subevents, 'dd', ShowDC) }}"
          ng-if="Abbr.hasType(data[id].config.subevents, 'dd')">Double Dutch</th>
        <th bold="true" colspan="3" rowspan="2">Overall</th>
      </tr>
      <tr>
        <th bold="true" colspan="{{ (!ShowDC || Abbr.isSpeed(event) ? 2 : 10) }}" ng-repeat="event in Abbr.events track by $index"
          ng-if="data[id].config.subevents[event]">{{ Abbr.unabbr(event)}}</th>
      </tr>
      <tr>
        <th bold="true">{{ (Abbr.hasTeam(data[id].config.subevents) ? "Team Name" : "Name") }}</th>
        <th bold="true">Club</th>
        <th bold="true">id</th>

        <th bold="true" class="gray" argb="FF808080" ng-repeat-start="event in Abbr.events track by $index"
          ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">Presentation</th>
        <th bold="true" class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">Required Elements</th>
        <th bold="true" class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">Difficulty</th>
        <th bold="true" class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">Deductions</th>
        <th bold="true" class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">Creativity - (deductions / 2)</th>
        <th bold="true" class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">Rank</th>
        <th bold="true" class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">Difficulty - (deductions / 2)</th>
        <th bold="true" class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">Rank</th>
        <th bold="true" ng-if="data[id].config.subevents[event]">Score</th>
        <th bold="true" ng-if="data[id].config.subevents[event]" class="red" argb="FFFF0000"
          ng-repeat-end>{{ (data[id].config.simplified && data[id].config.factors && data[id].config.factors[event]
          ? (data[id].config.factors[event] != 1 ? data[id].config.factors[event]
          + 'x' : '') : (event == 'srsf' ? '2x' : '')) }} Rank</th>

        <th bold="true">Score</th>
        <th bold="true" class="green" argb="FF008000">Rank Sum</th>
        <th bold="true" class="red" argb="FFFF0000">Rank</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="part in partArray | orderBy : 'uid' : false : comparator.overall"
        ng-style="($even ? {} : {'background-color':'#eee'})">
        <td>{{ data[id].participants[part.uid].name }}</td>
        <td>{{ data[id].participants[part.uid].club }}</td>
        <td>{{ part.uid }}</td>

        <td class="gray" argb="FF808080" ng-repeat-start="event in Abbr.events track by $index"
          ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">{{ roundTo(data[id].finalscores[part.uid][event].pres, 2) || '' }}</td>
        <td class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">{{ roundTo(data[id].finalscores[part.uid][event].req, 2) || '' }}</td>
        <td class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">{{ roundTo(data[id].finalscores[part.uid][event].diff, 2) || '' }}</td>
        <td class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">{{ roundTo(-data[id].finalscores[part.uid][event].deduc, 2) || '' }}</td>
        <td class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">{{ roundTo(data[id].finalscores[part.uid][event].crea - (data[id].finalscores[part.uid][event].deduc
          / 2), 2) || '' }}</td>
        <td class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">{{ data[id].hiddenRanks[part.uid][event].crea }}</td>
        <td class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">{{ roundTo(data[id].finalscores[part.uid][event].diff - (data[id].finalscores[part.uid][event].deduc
          / 2), 2) || '' }}</td>
        <td class="gray" argb="FF808080" ng-if="ShowDC && data[id].config.subevents[event] && !Abbr.isSpeed(event)">{{ data[id].hiddenRanks[part.uid][event].diff }}</td>
        <td ng-if="data[id].config.subevents[event]">{{ score(event, dataNow()[id].scores[part.uid][event], part.uid, 'PreY')
          }}
        </td>
        <td ng-if="data[id].config.subevents[event]" class="red" argb="FFFF0000" ng-repeat-end>{{ rank(data[id].finalscores, event, part.uid) }}</td>

        <td>{{ finalscore(data[id].finalscores[part.uid]) }}</td>
        <td class="green" argb="FF008000">{{ ranksum(data[id].ranks[part.uid]) }}</td>
        <td class="red" argb="FFFF0000">{{ rank(data[id].ranks, 'ranksum', part.uid) }}
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div ng-show="ShowAllTables">
  <div class="table">
    <table name="overall">
      <thead>
        <tr>
          <th bold="true" noborders colspan="{{ (3 + Abbr.header(data[id].config.subevents, 'sr', false) + Abbr.header(data[id].config.subevents, 'dd', false) + 3) }}">{{ data[id].config.name }} Overall Results</th>
        </tr>
        <tr>
          <th bold="true" class="blank" noborders colspan="3" rowspan="2"></th>
          <th bold="true" colspan="{{ Abbr.header(data[id].config.subevents, 'sr', false) }}"
            ng-if="Abbr.hasType(data[id].config.subevents, 'sr')">Single Rope</th>
          <th bold="true" colspan="{{ Abbr.header(data[id].config.subevents, 'dd', false) }}"
            ng-if="Abbr.hasType(data[id].config.subevents, 'dd')">Double Dutch</th>
          <th bold="true" colspan="3" rowspan="2">Overall</th>
        </tr>
        <tr>
          <th bold="true" colspan="2" ng-repeat="event in Abbr.events track by $index" ng-if="data[id].config.subevents[event]">{{ Abbr.unabbrNoType(event)}}</th>
        </tr>
        <tr>
          <th bold="true">{{ (Abbr.hasTeam(data[id].config.subevents) ? "Team Name" : "Name") }}</th>
          <th bold="true">Club</th>
          <th bold="true">id</th>

          <th bold="true" ng-if="data[id].config.subevents[event]" ng-repeat-start="event in Abbr.events track by $index">Score</th>
          <th bold="true" ng-if="data[id].config.subevents[event]" class="red" argb="FFFF0000"
            ng-repeat-end>{{ (data[id].config.simplified && data[id].config.factors && data[id].config.factors[event]
            ? (data[id].config.factors[event] != 1 ? data[id].config.factors[event]
            + 'x' : '') : (event == 'srsf' ? '2x' : '')) }} Rank</th>

          <th bold="true">Score</th>
          <th bold="true" class="green" argb="FF008000">Rank Sum</th>
          <th bold="true" class="red" argb="FFFF0000">Rank</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="part in partArray | orderBy : 'uid' : false : comparator.overall"
          ng-style="($even ? {} : {'background-color':'#eee'})">
          <td>{{ data[id].participants[part.uid].name }}</td>
          <td>{{ data[id].participants[part.uid].club }}</td>
          <td>{{ part.uid }}</td>

          <td ng-if="data[id].config.subevents[event]" ng-repeat-start="event in Abbr.events track by $index">{{ score(event, dataNow()[id].scores[part.uid][event], part.uid) }}</td>
          <td ng-if="data[id].config.subevents[event]" class="red" argb="FFFF0000" ng-repeat-end>{{ rank(data[id].finalscores, event, part.uid) }}</td>

          <td>{{ finalscore(data[id].finalscores[part.uid]) }}</td>
          <td class="green" argb="FF008000">{{ ranksum(data[id].ranks[part.uid]) }}</td>
          <td class="red" argb="FFFF0000">{{ rank(data[id].ranks, 'ranksum', part.uid) || '' }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="table" ng-repeat="event in Abbr.events track by $index" ng-if="data[id].config.subevents[event]">
    <table name="{{ event }}" class="mt">
      <thead>
        <tr>
          <th bold="true" colspan="5" ng-if="Abbr.isSpeed(event)">{{ data[id].config.name }} Scores: {{ Abbr.unabbr(event)}}</th>
          <th bold="true" colspan="13" ng-if="!Abbr.isSpeed(event)">{{ data[id].config.name }} Scores: {{ Abbr.unabbr(event)}}</th>
        </tr>
        <tr>
          <th bold="true">{{ (Abbr.hasTeam(data[id].config.subevents) ? " Team Name " : "Name ")
            }}
          </th>
          <th bold="true">Club</th>
          <th bold="true">id</th>

          <th bold="true" class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">Pres</th>
          <th bold="true" class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">Req El</th>
          <th bold="true" class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">Diff</th>
          <th bold="true" class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">Deduc</th>
          <th bold="true" class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">Crea - Deduc/2</th>
          <th bold="true" class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">Rank</th>
          <th bold="true" class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">Diff - Deduc/2</th>
          <th bold="true" class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">Rank</th>

          <th bold="true">Score</th>
          <th bold="true" class="red" argb="FFFF0000">{{ (data[id].config.simplified && data[id].config.factors && data[id].config.factors[event]
            ? (data[id].config.factors[event] != 1 ? data[id].config.factors[event]
            + 'x' : '') : (event == 'srsf' ? '2x' : '')) }} Rank</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="part in partArray | orderBy : 'uid' : false : comparator[event]" ng-style="($even ?
    {} : { 'background-color': '#eee'}) ">
          <td>{{ data[id].participants[part.uid].name }}</td>
          <td>{{ data[id].participants[part.uid].club }}</td>
          <td>{{ part.uid }}</td>

          <td ng-if="Abbr.isSpeed(event)">{{ roundTo(data[id].finalscores[part.uid][event] / speedFactor(event),
            2) || '' }}</td>

          <td class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">{{ roundTo(data[id].finalscores[part.uid][event].pres, 2) || '' }}</td>
          <td class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">{{ roundTo(data[id].finalscores[part.uid][event].req, 2) || '' }}</td>
          <td class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">{{ roundTo(data[id].finalscores[part.uid][event].diff, 2) || '' }}</td>
          <td class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">{{ roundTo(-data[id].finalscores[part.uid][event].deduc, 2) || '' }}</td>
          <td class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">{{ roundTo(data[id].finalscores[part.uid][event].crea - (data[id].finalscores[part.uid][event].deduc
            / 2), 2) || '' }}</td>
          <td class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">{{ data[id].hiddenRanks[part.uid][event].crea }}</td>
          <td class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">{{ roundTo(data[id].finalscores[part.uid][event].diff - (data[id].finalscores[part.uid][event].deduc
            / 2), 2) || '' }}</td>
          <td class="gray" argb="FF808080" ng-if="!Abbr.isSpeed(event)">{{ data[id].hiddenRanks[part.uid][event].diff }}</td>
          <td ng-if="!Abbr.isSpeed(event)">{{ roundTo(data[id].finalscores[part.uid][event].total, 2) || '' }}</td>

          <td class="red" argb="FFFF0000">{{ data[id].ranks[part.uid][event] || '' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- <pre>{{ data[id] | json }}</pre> -->
