<h1>{{ data[id].config.name }} Results</h1>
<div>
    <table id="resultsTable">
        <thead>
            <tr>
                <th class="blank" colspan="3" rowspan="2"></th>
                <th colspan="{{ Abbr.count(data[id].config.subevents, 'sr') * 2 }}">Single Rope</th>
                <th colspan="{{ Abbr.count(data[id].config.subevents, 'dd') * 2 }}">Double Dutch</th>
                <th colspan="3" rowspan="2">Overall</th>
            </tr>
            <tr>
                <th colspan="2" ng-if="data[id].config.subevents.srss">{{ Abbr.unabbr("srss")}}</th>
                <th colspan="2" ng-if="data[id].config.subevents.srse">{{ Abbr.unabbr("srse")}}</th>
                <th colspan="2" ng-if="data[id].config.subevents.srsf">{{ Abbr.unabbr("srsf")}}</th>
                <th colspan="2" ng-if="data[id].config.subevents.srsr">{{ Abbr.unabbr("srsr")}}</th>
                <th colspan="2" ng-if="data[id].config.subevents.srpf">{{ Abbr.unabbr("srpf")}}</th>
                <th colspan="2" ng-if="data[id].config.subevents.srtf">{{ Abbr.unabbr("srtf")}}</th>
                <th colspan="2" ng-if="data[id].config.subevents.srp">{{ Abbr.unabbr("srp")}}</th>
                <th colspan="2" ng-if="data[id].config.subevents.srd">{{ Abbr.unabbr("srd")}}</th>

                <th colspan="2" ng-if="data[id].config.subevents.ddsr">{{ Abbr.unabbr("ddsr")}}</th>
                <th colspan="2" ng-if="data[id].config.subevents.ddsf">{{ Abbr.unabbr("ddsf")}}</th>
                <th colspan="2" ng-if="data[id].config.subevents.ddpf">{{ Abbr.unabbr("ddpf")}}</th>
            </tr>
            <tr>
                <th>Team Name</th>
                <th>Club</th>
                <th>id</th>

                <th ng-repeat-start="n in getNumber(Abbr.count(data[id].config.subevents)) track by $index">Score</th>
                <th style="color:red" ng-repeat-end>Rank</th>

                <th>Score</th>
                <th style="color:green">Rank Sum</th>
                <th style="color:red">Rank</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="(uid, participant) in data[id].participants track by $index" ng-style="($even ? {} : {'background-color':'#eee'})">
                <!-- | orderBy : rank(data[id].ranks, 'ranksum', uid) -->
                <td>{{ participant.name }}</td>
                <td>{{ participant.club }}</td>
                <td>{{ uid }}</td>

                <td ng-if="data[id].config.subevents.srss">{{ score("srss", data[id].scores[uid].srss, uid)}}</td>
                <td ng-if="data[id].config.subevents.srss" style="color:red">{{ rank(data[id].finalscores, 'srss', uid) }}</td>
                <td ng-if="data[id].config.subevents.srse">{{ score("srse", data[id].scores[uid].srse, uid)}}</td>
                <td ng-if="data[id].config.subevents.srse" style="color:red">{{ rank(data[id].finalscores, 'srss', uid) }}</td>
                <td ng-if="data[id].config.subevents.srsf">{{ score("srsf", data[id].scores[uid].srsf, uid)}}</td>
                <td ng-if="data[id].config.subevents.srsf" style="color:red">{{ rank(data[id].finalscores, 'srsf', uid) }}</td>
                <td ng-if="data[id].config.subevents.srsr">{{ score("srsr", data[id].scores[uid].srsr, uid) }}</td>
                <td ng-if="data[id].config.subevents.srsr" style="color:red">{{ rank(data[id].finalscores, 'srsr', uid) }}</td>
                <td ng-if="data[id].config.subevents.srpf">{{ score("srpf", data[id].scores[uid].srpf, uid) }}</td>
                <td ng-if="data[id].config.subevents.srpf" style="color:red">{{ rank(data[id].finalscores, 'srpf', uid) }}</td>
                <td ng-if="data[id].config.subevents.srtf">{{ score("srtf", data[id].scores[uid].srtf, uid) }}</td>
                <td ng-if="data[id].config.subevents.srtf" style="color:red">{{ rank(data[id].finalscores, 'srtf', uid) }}</td>
                <td ng-if="data[id].config.subevents.srp">{{ score("srp", data[id].scores[uid].srp, uid)}}</td>
                <td ng-if="data[id].config.subevents.srp" style="color:red">{{ rank(data[id].finalscores, 'srp', uid) }}</td>
                <td ng-if="data[id].config.subevents.srd">{{ score("srd", data[id].scores[uid].srd, uid)}}</td>
                <td ng-if="data[id].config.subevents.srd" style="color:red">{{ rank(data[id].finalscores, 'srd', uid) }}</td>

                <td ng-if="data[id].config.subevents.ddsr">{{ score("ddsr", data[id].scores[uid].ddsr, uid)}}</td>
                <td ng-if="data[id].config.subevents.ddsr" style="color:red">{{ rank(data[id].finalscores, 'ddsr', uid) }}</td>
                <td ng-if="data[id].config.subevents.ddsf">{{ score("ddsf", data[id].scores[uid].ddsf, uid) }}</td>
                <td ng-if="data[id].config.subevents.ddsf" style="color:red">{{ rank(data[id].finalscores, 'ddsf', uid) }}</td>
                <td ng-if="data[id].config.subevents.ddpf">{{ score("ddpf", data[id].scores[uid].ddpf, uid) }}</td>
                <td ng-if="data[id].config.subevents.ddpf" style="color:red">{{ rank(data[id].finalscores, 'ddpf', uid) }}</td>

                <td>{{ finalscore(data[id].finalscores[uid]) }}</td>
                <td style="color:green">{{ ranksum(data[id].ranks[uid]) }}</td>
                <td style="color:red">{{ rank(data[id].ranks, 'ranksum', uid) }}</td>
            </tr>
        </tbody>
    </table>
</div>

<button onclick="tableToExcel('resultsTable')">Export to excel</button>
