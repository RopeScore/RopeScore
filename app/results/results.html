<h1>{{ data[id].config.name }} Results</h1>
<div class="table">
  <table id="resultsTable">
    <thead>
      <tr>
        <th class="blank" colspan="3" rowspan="2"></th>
        <th colspan="{{ Abbr.count(data[id].config.subevents, 'sr') * 2 }}" ng-if="Abbr.hasType(data[id].config.subevents, 'sr')">Single Rope</th>
        <th colspan="{{ Abbr.count(data[id].config.subevents, 'dd') * 2 }}" ng-if="Abbr.hasType(data[id].config.subevents, 'dd')">Double Dutch</th>
        <th colspan="3" rowspan="2">Overall</th>
      </tr>
      <tr>
        <th colspan="2" ng-repeat="event in Abbr.events track by $index" ng-if="data[id].config.subevents[event]">{{ Abbr.unabbr(event)}}</th>
      </tr>
      <tr>
        <th>{{ (Abbr.hasTeam(data[id].config.subevents) ? "Team Name" : "Name") }}</th>
        <th>Club</th>
        <th>id</th>

        <th ng-repeat-start="event in Abbr.events track by $index" ng-if="data[id].config.subevents[event]">Score</th>
        <th ng-if="data[id].config.subevents[event]" style="color:red" ng-repeat-end>{{ (data[id].config.simplified && data[id].config.factors && data[id].config.factors[event]
          ? (data[id].config.factors[event] != 1 ? data[id].config.factors[event]
          + 'x' : '') : (event == 'srsf' ? '2x' : '')) }} Rank</th>

        <th>Score</th>
        <th style="color:green">Rank Sum</th>
        <th style="color:red">Rank</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="part in partArray | orderBy :'rank'" ng-style="($even ? {} : {'background-color':'#eee'})">
        <td>{{ data[id].participants[part.uid].name }}</td>
        <td>{{ data[id].participants[part.uid].club }}</td>
        <td>{{ part.uid }}</td>

        <td ng-repeat-start="event in Abbr.events track by $index" ng-if="data[id].config.subevents[event]">{{ score(event, dataNow()[id].scores[part.uid][event], part.uid) }}</td>
        <td ng-if="data[id].config.subevents[event]" style="color:red" ng-repeat-end>{{ rank(data[id].finalscores, event, part.uid) }}</td>

        <td>{{ finalscore(data[id].finalscores[part.uid]) }}</td>
        <td style="color:green">{{ ranksum(data[id].ranks[part.uid]) }}</td>
        <td style="color:red">{{ rank(data[id].ranks, 'ranksum', part.uid) }}
        </td>
      </tr>
    </tbody>
  </table>
</div>

<button onclick="tableToExcel('resultsTable')">Export to excel</button>

<!-- <pre>{{ data[id] | json }}</pre> -->
